<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OAuth Redirect Test</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .card {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    h1 {
      color: #1a1a1a;
      margin-bottom: 10px;
    }
    .url {
      background: #f0f0f0;
      padding: 12px;
      border-radius: 6px;
      font-family: monospace;
      font-size: 14px;
      margin: 10px 0;
      word-break: break-all;
    }
    .success {
      color: #059669;
      font-weight: 600;
    }
    .error {
      color: #dc2626;
      font-weight: 600;
    }
    .button {
      background: #2563eb;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      margin: 10px 5px 10px 0;
    }
    .button:hover {
      background: #1d4ed8;
    }
    .info {
      background: #dbeafe;
      border-left: 4px solid #2563eb;
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>üîç OAuth Redirect URL Diagnostic</h1>
    <p>This tool shows you the exact URLs that need to be configured in Supabase.</p>
  </div>

  <div class="card">
    <h2>Current Environment</h2>
    <div class="url">
      <strong>Origin:</strong> <span id="origin"></span>
    </div>
    <div class="url">
      <strong>Required Callback URL:</strong><br>
      <span id="callback-url"></span>
    </div>
    <div class="url">
      <strong>With Admin Redirect:</strong><br>
      <span id="callback-with-next"></span>
    </div>
  </div>

  <div class="card">
    <h2>üìã Copy These URLs to Supabase</h2>
    <div class="info">
      <strong>Go to:</strong> <a href="https://app.supabase.com/project/dugolglucuzolzvuqxmi/auth/url-configuration" target="_blank">Supabase URL Configuration</a>
      <br><br>
      <strong>Add these Redirect URLs (click "Add URL" for each):</strong>
    </div>
    
    <div class="url" id="url1"></div>
    <button class="button" onclick="copyUrl('url1')">Copy URL 1</button>
    
    <div class="url" id="url2"></div>
    <button class="button" onclick="copyUrl('url2')">Copy URL 2</button>
    
    <div class="url" id="url3"></div>
    <button class="button" onclick="copyUrl('url3')">Copy URL 3</button>
    
    <div class="url" id="url4"></div>
    <button class="button" onclick="copyUrl('url4')">Copy URL 4</button>
  </div>

  <div class="card">
    <h2>‚úÖ Verification</h2>
    <p>After adding the URLs to Supabase:</p>
    <ol>
      <li>Wait 2 minutes for changes to propagate</li>
      <li>Clear browser cache and cookies</li>
      <li>Try <a href="/admin/login">Admin Login</a> again</li>
    </ol>
  </div>

  <script>
    const origin = window.location.origin;
    const callbackUrl = origin + '/auth/callback';
    const callbackWithNext = callbackUrl + '?next=/admin';
    const adminUrl = origin + '/admin';
    const adminLogin = origin + '/admin/login';

    document.getElementById('origin').textContent = origin;
    document.getElementById('callback-url').textContent = callbackUrl;
    document.getElementById('callback-with-next').textContent = callbackWithNext;

    document.getElementById('url1').textContent = callbackUrl;
    document.getElementById('url2').textContent = callbackWithNext;
    document.getElementById('url3').textContent = adminUrl;
    document.getElementById('url4').textContent = adminLogin;

    function copyUrl(elementId) {
      const text = document.getElementById(elementId).textContent;
      navigator.clipboard.writeText(text).then(() => {
        alert('‚úÖ Copied to clipboard: ' + text);
      });
    }

    // Auto-populate Site URL
    console.log('=== SUPABASE CONFIGURATION ===');
    console.log('Site URL:', origin);
    console.log('Redirect URLs to add:');
    console.log('1.', callbackUrl);
    console.log('2.', callbackWithNext);
    console.log('3.', adminUrl);
    console.log('4.', adminLogin);
    console.log('=============================');
  </script>
</body>
</html>

